from pymongo import MongoClient

# TODO: Put database's information into config file
DB_HOST_IP = '127.0.0.1'
DB_PORT = 27017


class Database:
    def __init__(self):
        self.db_client = MongoClient(host=DB_HOST_IP, port=DB_PORT)
        self.db = self.db_client.malware_db
        self.predicted = self.db.predicted

    def save_data_to_database(self, file_name: str, data: dict):
        self.predicted.insert_one({'file': file_name, 'prediction': data})

    def retrieve_data_from_database(self, file_name: str) -> dict:
        retrieved_prediction = self.predicted.find_one({'file': file_name})
        if retrieved_prediction is None:
            return None
        else:
            return retrieved_prediction['prediction']
