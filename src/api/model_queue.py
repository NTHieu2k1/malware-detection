from redis import Redis
from rq import Queue

# TODO: Put queue's information into config file
QUEUE_HOST_IP = '127.0.0.1'
QUEUE_PORT = 6835


class ModelQueue:
    def __init__(self):
        self.queue_client = Redis(host=QUEUE_HOST_IP, port=QUEUE_PORT)
        self.queue = Queue(connection=self.queue_client)

    def enqueue(self, function, *args, keeping_time=0):
        self.queue.enqueue(function, *args, result_ttl=keeping_time)
